```
核心模块更像是框架，
其余的模块更像是一个函数。一个模块实现一个功能。
```

http模块是如何介入

```
worker进程会在一个for循环反复调用事件模块检测网络事件
```

![image-20210630225027316](C:\Users\Echo\AppData\Roaming\Typora\typora-user-images\image-20210630225027316.png)

```
对上图的总结:
1.事件模块检测网络事件，建立连接后会根据配置文件交给HTTP框架处理
2.框架负责接受完成的请求头/请求体。再根据请求的URL等分配到location
3.在处理请求结束时，会依次调用过滤模块，(决定是否压缩等等)
```

```
一个location相当于对应一个文件夹(源目录)，可以匹配文件夹内的任意的html
```

两种调用方式

```
如果想使得某一模块（功能)对任一请求都生效，如access_moduel..其在ACCESS_phase阶段工作，对任意模块都生效。而自己设计的大部分模块都只需要对匹配了某一location的请求生效即可，
```

模块开发综述

```
1.模块的名字(类比函数名)
2.配置指令和参数  相当于传入参数-----------cmd
3.业务逻辑开发  (主要的功能实现)
4.框架注册   将业务逻辑加入到请求的处理
5.模块集成   实现module_t中的cmds和ctx结构里的回调函数
6.编译       将我们给定的源代码和config编译进Nginx(3.3.2两种方法)
```

```
ctx是不同类型模块的公共接口。使得每个模块都有自己的特性。实际为不同的接口函数
http模块有八个接口函数
```

```
http模块基本都需要用到请求的信息，所有请求信息都可以在http_request_t结构体中
```

